<Page x:Class="BiometricEnrollmentApp.EnrollmentPage"
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="SecureAttend | Biometric Enrollment"
      Background="#F6F7F9"
      FontFamily="Segoe UI">

    <Page.Resources>
        <SolidColorBrush x:Key="PrimaryColor" Color="#106EBE"/>
        <SolidColorBrush x:Key="SuccessColor" Color="#107C10"/>
        <SolidColorBrush x:Key="TextDark" Color="#212121"/>
        <SolidColorBrush x:Key="TextLight" Color="#616161"/>
        <DropShadowEffect x:Key="CardShadow" BlurRadius="25" ShadowDepth="5" Direction="270" Color="#DDDDDD" Opacity="0.7"/>
    </Page.Resources>

    <ScrollViewer VerticalScrollBarVisibility="Auto" HorizontalScrollBarVisibility="Disabled">
        <Grid Margin="20">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <StackPanel Grid.Row="0" Margin="0,0,0,20">
                <TextBlock Text="Fingerprint Enrollment" 
                           FontSize="24" FontWeight="Bold" 
                           Foreground="#1E3A8A"
                           Margin="0,0,0,8"/>
                <TextBlock Text="Enroll and manage employee fingerprints" 
                           FontSize="14" 
                           Foreground="#6B7280"/>
            </StackPanel>

            <!-- Main Content -->
            <Grid Grid.Row="1" Margin="0,0,0,20">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="1*" MinWidth="400" MaxWidth="550"/>
                    <ColumnDefinition Width="1.5*" MinWidth="600"/>
                </Grid.ColumnDefinitions>

                <!-- LEFT PANEL: Enrollment Section -->
                <Border Grid.Column="0" Background="White" 
                        CornerRadius="12" Padding="20" Margin="0,0,6,0"
                        BorderBrush="#cbd5e1" BorderThickness="1">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Header -->
                    <TextBlock Grid.Row="0"
                               Text="ðŸ§¬ Enroll Fingerprint"
                               FontSize="22"
                               FontWeight="Bold"
                               Foreground="#1e293b"
                               Margin="0,0,0,16"/>

                    <!-- Employee Input -->
                    <StackPanel Grid.Row="1" Margin="0,0,0,16">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            
                            <TextBlock Grid.Column="0" Text="Employee ID"
                                       FontSize="13"
                                       FontWeight="SemiBold"
                                       Foreground="#334155"
                                       Margin="0,0,0,6"/>
                            
                            <TextBlock Grid.Column="1" Text="(Available employees only)"
                                       FontSize="11"
                                       FontStyle="Italic"
                                       Foreground="#6B7280"
                                       HorizontalAlignment="Right"
                                       VerticalAlignment="Bottom"
                                       Margin="0,0,0,6"/>
                        </Grid>
                        
                        <Grid>
                            <ComboBox x:Name="EmployeeIdInput"
                                      Height="36"
                                      FontSize="14"
                                      Padding="6"
                                      BorderBrush="#cbd5e1"
                                      BorderThickness="1"
                                      Background="#f8fafc"
                                      IsEditable="True"
                                      IsTextSearchEnabled="False"
                                      StaysOpenOnEdit="True"
                                      KeyUp="EmployeeIdInput_KeyUp"
                                      SelectionChanged="EmployeeIdInput_SelectionChanged"
                                      DropDownOpened="EmployeeIdInput_DropDownOpened"
                                      GotFocus="EmployeeIdInput_GotFocus">
                                <ComboBox.ItemTemplate>
                                    <DataTemplate>
                                        <StackPanel Orientation="Horizontal" Margin="2">
                                            <TextBlock Text="{Binding EmployeeId}" FontWeight="SemiBold" Width="80"/>
                                            <TextBlock Text=" - " Margin="5,0"/>
                                            <TextBlock Text="{Binding FullName}" Width="150"/>
                                            <TextBlock Text=" (" Margin="5,0,0,0"/>
                                            <TextBlock Text="{Binding Department}" FontStyle="Italic" Foreground="#6B7280"/>
                                            <TextBlock Text=")"/>
                                        </StackPanel>
                                    </DataTemplate>
                                </ComboBox.ItemTemplate>
                            </ComboBox>
                            
                            <!-- Placeholder text -->
                            <TextBlock x:Name="PlaceholderText"
                                       Text="Type to search or click dropdown..."
                                       FontSize="14"
                                       Foreground="#9CA3AF"
                                       FontStyle="Italic"
                                       Margin="8,0,0,0"
                                       VerticalAlignment="Center"
                                       IsHitTestVisible="False">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Setter Property="Visibility" Value="Collapsed"/>
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding Text, ElementName=EmployeeIdInput}" Value="">
                                                <Setter Property="Visibility" Value="Visible"/>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding Text, ElementName=EmployeeIdInput}" Value="{x:Null}">
                                                <Setter Property="Visibility" Value="Visible"/>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </Grid>
                    </StackPanel>

                    <!-- Action buttons -->
                    <StackPanel Grid.Row="2" Margin="0,0,0,16">
                        <Button x:Name="EnrollBtn"
                                Content="ðŸ–ï¸ Enroll Fingerprint"
                                Height="44"
                                FontSize="14"
                                FontWeight="SemiBold"
                                Background="#10b981"
                                Foreground="White"
                                BorderThickness="0"
                                Click="EnrollBtn_Click"
                                IsEnabled="True"
                                Margin="0,0,0,10"
                                Cursor="Hand">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}"
                                            CornerRadius="8"
                                            Padding="{TemplateBinding Padding}">
                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#059669"/>
                                        </Trigger>
                                        <Trigger Property="IsPressed" Value="True">
                                            <Setter Property="Background" Value="#047857"/>
                                        </Trigger>
                                        <Trigger Property="IsEnabled" Value="False">
                                            <Setter Property="Opacity" Value="0.6"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </StackPanel>

                    <!-- Fingerprint preview -->
                    <Border Grid.Row="3"
                            Background="#f1f5f9"
                            CornerRadius="10"
                            Padding="20"
                            Margin="0,0,0,16">
                        <Border Width="200"
                                Height="200"
                                Background="White"
                                CornerRadius="8"
                                Padding="10"
                                BorderBrush="#e2e8f0"
                                BorderThickness="1">
                            <Image x:Name="FingerprintPreview"
                                   Stretch="Uniform"
                                   HorizontalAlignment="Center"
                                   VerticalAlignment="Center"
                                   Source="/Assets/fingerprint_placeholder.png"/>
                        </Border>
                    </Border>

                    <!-- Footer -->
                    <TextBlock Grid.Row="5"
                               Text="Ready to enroll fingerprints"
                               FontSize="11"
                               Foreground="#94a3b8"
                               HorizontalAlignment="Center"/>
                </Grid>
            </Border>

            <!-- RIGHT PANEL: Manage Fingerprint Records -->
            <Border Grid.Column="1" Background="White" 
                    CornerRadius="12" Padding="20" Margin="6,0,0,0"
                    BorderBrush="#cbd5e1" BorderThickness="1">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Header -->
                    <StackPanel Grid.Row="0" Margin="0,0,0,16">
                        <TextBlock Text="ðŸ“‹ Manage Fingerprint Records" 
                                   FontSize="22" FontWeight="Bold" 
                                   Foreground="#1e293b"
                                   Margin="0,0,0,8"/>
                        <TextBlock Text="View and manage enrolled employees" 
                                   FontSize="13" 
                                   Foreground="#64748b"
                                   Margin="0,0,0,12"/>
                        <Button x:Name="RefreshRecordsBtn"
                                Content="ðŸ”„ Refresh List"
                                Width="140"
                                Height="36"
                                FontSize="13"
                                Background="#e5e7eb"
                                Foreground="#1f2937"
                                BorderThickness="0"
                                HorizontalAlignment="Left"
                                Click="RefreshRecordsBtn_Click"
                                Cursor="Hand">
                            <Button.Template>
                                <ControlTemplate TargetType="Button">
                                    <Border Background="{TemplateBinding Background}"
                                            CornerRadius="8"
                                            Padding="{TemplateBinding Padding}">
                                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                    </Border>
                                    <ControlTemplate.Triggers>
                                        <Trigger Property="IsMouseOver" Value="True">
                                            <Setter Property="Background" Value="#d1d5db"/>
                                        </Trigger>
                                        <Trigger Property="IsPressed" Value="True">
                                            <Setter Property="Background" Value="#9ca3af"/>
                                        </Trigger>
                                    </ControlTemplate.Triggers>
                                </ControlTemplate>
                            </Button.Template>
                        </Button>
                    </StackPanel>

                    <!-- Data Grid -->
                    <DataGrid x:Name="EnrollmentsGrid" Grid.Row="1" 
                              AutoGenerateColumns="False" 
                              IsReadOnly="True" 
                              CanUserResizeRows="False"
                              HeadersVisibility="Column"
                              GridLinesVisibility="None"
                              Background="White"
                              BorderBrush="#e5e7eb"
                              BorderThickness="1"
                              RowHeight="40"
                              ColumnHeaderHeight="44"
                              AlternatingRowBackground="#f9fafb"
                              SelectionMode="Single"
                              SelectionUnit="FullRow">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="Employee ID" Binding="{Binding EmployeeId}" Width="1*"/>
                            <DataGridTextColumn Header="Name" Binding="{Binding Name}" Width="1*"/>
                            <DataGridTextColumn Header="Department" Binding="{Binding Department}" Width="1*"/>
                            <DataGridTextColumn Header="Enrolled" Binding="{Binding CreatedAt}" Width="1*"/>
                            <DataGridTemplateColumn Header="Actions" Width="80">
                                <DataGridTemplateColumn.CellTemplate>
                                    <DataTemplate>
                                        <Button Content="ðŸ—‘ï¸"
                                                FontSize="16"
                                                Width="28"
                                                Height="28"
                                                Background="#ef4444"
                                                Foreground="White"
                                                BorderThickness="0"
                                                Click="DeleteEnrollmentBtn_Click"
                                                Tag="{Binding EmployeeId}"
                                                HorizontalAlignment="Center"
                                                Cursor="Hand">
                                            <Button.Template>
                                                <ControlTemplate TargetType="Button">
                                                    <Border Background="{TemplateBinding Background}"
                                                            CornerRadius="6"
                                                            Padding="{TemplateBinding Padding}">
                                                        <ContentPresenter HorizontalAlignment="Center" 
                                                                          VerticalAlignment="Center"/>
                                                    </Border>
                                                </ControlTemplate>
                                            </Button.Template>
                                            <Button.Style>
                                                <Style TargetType="Button">
                                                    <Setter Property="Background" Value="#ef4444"/>
                                                    <Style.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Background" Value="#dc2626"/>
                                                        </Trigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Button.Style>
                                        </Button>
                                    </DataTemplate>
                                </DataGridTemplateColumn.CellTemplate>
                            </DataGridTemplateColumn>
                        </DataGrid.Columns>
                        
                        <DataGrid.ColumnHeaderStyle>
                            <Style TargetType="DataGridColumnHeader">
                                <Setter Property="Background" Value="#f1f5f9"/>
                                <Setter Property="Foreground" Value="#1e293b"/>
                                <Setter Property="FontSize" Value="13"/>
                                <Setter Property="FontWeight" Value="SemiBold"/>
                                <Setter Property="Padding" Value="12,8"/>
                                <Setter Property="BorderThickness" Value="0"/>
                                <Setter Property="HorizontalContentAlignment" Value="Center"/>
                            </Style>
                        </DataGrid.ColumnHeaderStyle>
                        
                        <DataGrid.CellStyle>
                            <Style TargetType="DataGridCell">
                                <Setter Property="Padding" Value="12,6"/>
                                <Setter Property="Foreground" Value="#1f2937"/>
                                <Setter Property="BorderThickness" Value="0"/>
                                <Setter Property="TextBlock.TextAlignment" Value="Center"/>
                                <Setter Property="VerticalContentAlignment" Value="Center"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="DataGridCell">
                                            <Border Background="{TemplateBinding Background}"
                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                    BorderThickness="{TemplateBinding BorderThickness}"
                                                    Padding="{TemplateBinding Padding}">
                                                <ContentPresenter VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="Foreground" Value="#1f2937"/>
                                        <Setter Property="BorderBrush" Value="Transparent"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.CellStyle>
                        
                        <DataGrid.RowStyle>
                            <Style TargetType="DataGridRow">
                                <Setter Property="SnapsToDevicePixels" Value="True"/>
                                <Style.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="BorderBrush" Value="Transparent"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.RowStyle>
                    </DataGrid>
                </Grid>
            </Border>
            </Grid>

            <!-- Footer -->
            <Border Grid.Row="2" Background="#F8FAFC" Padding="20" BorderBrush="#E2E8F0" BorderThickness="0,1,0,0">
                <Grid>
                    <TextBlock Text="Â© 2025 SecureAttend Systems" 
                               FontSize="12" 
                               Foreground="#64748B" 
                               HorizontalAlignment="Left" 
                               VerticalAlignment="Center"/>
                    
                    <TextBlock x:Name="StatusText"
                               Text="Ready - Device connected and templates loaded"
                               FontSize="13"
                               Foreground="#475569"
                               HorizontalAlignment="Right"
                               VerticalAlignment="Center"/>
                </Grid>
            </Border>

        </Grid>
    </ScrollViewer>
</Page>