<Page x:Class="BiometricEnrollmentApp.AttendancePage" 
      xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
      xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
      Title="Attendance"
      Background="#F0F0F0">

    <Page.Resources>
        <!-- Palette -->
        <Color x:Key="PrimaryColor">#1E3A8A</Color>
        <Color x:Key="AccentColor">#2563EB</Color>
        <Color x:Key="MutedText">#6B7280</Color>
        <Color x:Key="CardBg">#FFFFFF</Color>
        <Color x:Key="Surface">#F8FAFC</Color>
        <Color x:Key="GridHeaderBg">#EEF2FF</Color>
        <Color x:Key="RowAltBg">#FBFDFF</Color>
        <SolidColorBrush x:Key="PrimaryBrush" Color="{StaticResource PrimaryColor}"/>
        <SolidColorBrush x:Key="AccentBrush" Color="{StaticResource AccentColor}"/>
        <SolidColorBrush x:Key="MutedBrush" Color="{StaticResource MutedText}"/>
        <SolidColorBrush x:Key="CardBgBrush" Color="{StaticResource CardBg}"/>
        <SolidColorBrush x:Key="SurfaceBrush" Color="{StaticResource Surface}"/>
        <SolidColorBrush x:Key="GridHeaderBrush" Color="{StaticResource GridHeaderBg}"/>
        <SolidColorBrush x:Key="RowAltBrush" Color="{StaticResource RowAltBg}"/>

        <!-- Global text styles -->
        <Style TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="Foreground" Value="{StaticResource MutedBrush}"/>
        </Style>

        <Style x:Key="TitleText" TargetType="TextBlock" BasedOn="{StaticResource {x:Type TextBlock}}">
            <Setter Property="FontSize" Value="24"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="White"/>
        </Style>

        <Style x:Key="StatusTextStyle" TargetType="TextBlock" BasedOn="{StaticResource {x:Type TextBlock}}">
            <Setter Property="FontSize" Value="18"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
        </Style>

        <Style x:Key="InstructionTextStyle" TargetType="TextBlock" BasedOn="{StaticResource {x:Type TextBlock}}">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="Foreground" Value="#333333"/>
            <Setter Property="HorizontalAlignment" Value="Center"/>
            <Setter Property="TextAlignment" Value="Center"/>
        </Style>

        <!-- Button base: rounded, padding, hover -->
        <Style TargetType="Button">
            <Setter Property="FontFamily" Value="Segoe UI"/>
            <Setter Property="FontSize" Value="13"/>
            <Setter Property="Padding" Value="12,6"/>
            <Setter Property="MinWidth" Value="90"/>
            <Setter Property="MinHeight" Value="34"/>
            <Setter Property="Background" Value="#E5E7EB"/>
            <Setter Property="Foreground" Value="#111827"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="Bd"
                                Background="{TemplateBinding Background}"
                                CornerRadius="8"
                                SnapsToDevicePixels="True"
                                Padding="{TemplateBinding Padding}">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="Bd" Property="Background" Value="#D1D5DB"/>
                            </Trigger>
                            <Trigger Property="IsPressed" Value="True">
                                <Setter TargetName="Bd" Property="RenderTransform">
                                    <Setter.Value>
                                        <ScaleTransform ScaleX="0.99" ScaleY="0.99"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <Trigger Property="IsEnabled" Value="False">
                                <Setter TargetName="Bd" Property="Opacity" Value="0.6"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Accent primary button -->
        <Style x:Key="PrimaryButton" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Background" Value="{StaticResource AccentBrush}"/>
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="HorizontalAlignment" Value="Left"/>
        </Style>

        <!-- Small neutral button -->
        <Style x:Key="NeutralButton" TargetType="Button" BasedOn="{StaticResource {x:Type Button}}">
            <Setter Property="Background" Value="#F3F4F6"/>
            <Setter Property="Foreground" Value="#111827"/>
        </Style>

    </Page.Resources>

    <Grid x:Name="RootGrid">
        <!-- Main Attendance Display -->
        <Grid x:Name="MainAttendanceDisplay" Visibility="Visible">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>

            <!-- Header -->
            <Border Grid.Row="0" Background="#333333" Padding="20">
                <TextBlock Text="SecureAttend: Biometric Attendance" 
                           Style="{StaticResource TitleText}"
                           HorizontalAlignment="Center"/>
            </Border>

            <!-- Main Content -->
            <Grid Grid.Row="1" Background="#D0D0D0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Employee Photo and Info -->
                <StackPanel Grid.Row="1" HorizontalAlignment="Center" VerticalAlignment="Center" Margin="0,40,0,20">
                    <!-- Photo Container -->
                    <Border Background="White" 
                            Width="200" Height="200" 
                            CornerRadius="10"
                            BorderBrush="#CCCCCC" 
                            BorderThickness="2"
                            Margin="0,0,0,20">
                        <Grid>
                            <!-- Default User Icon -->
                            <Viewbox x:Name="DefaultUserIcon" Width="120" Height="120" Visibility="Visible">
                                <Canvas Width="24" Height="24">
                                    <Path Fill="#666666" Data="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/>
                                </Canvas>
                            </Viewbox>
                            
                            <!-- Employee Photo -->
                            <Image x:Name="EmployeePhoto" 
                                   Visibility="Collapsed"
                                   Stretch="UniformToFill"/>
                            
                            <!-- Camera Icon -->
                            <Border Background="#F0F0F0" 
                                    Width="30" Height="30" 
                                    CornerRadius="15"
                                    HorizontalAlignment="Right" 
                                    VerticalAlignment="Top"
                                    Margin="0,-10,-10,0">
                                <Viewbox Width="16" Height="16">
                                    <Canvas Width="24" Height="24">
                                        <Path Fill="#666666" Data="M9 2L7.17 4H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2h-3.17L15 2H9zm3 15c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5z"/>
                                    </Canvas>
                                </Viewbox>
                            </Border>
                        </Grid>
                    </Border>

                    <!-- Employee ID Input (for manual entry) -->
                    <Border Background="White" 
                            Width="300" Height="40" 
                            CornerRadius="5"
                            BorderBrush="#CCCCCC" 
                            BorderThickness="1"
                            Margin="0,0,0,20"
                            x:Name="EmployeeIdBorder"
                            Visibility="Collapsed">
                        <TextBox x:Name="EmployeeIdTextBox" 
                                 Text="Enter Employee ID"
                                 FontSize="14"
                                 Foreground="#999999"
                                 Background="Transparent"
                                 BorderThickness="0"
                                 VerticalAlignment="Center"
                                 HorizontalAlignment="Center"
                                 TextAlignment="Center"/>
                    </Border>

                    <!-- Employee Name -->
                    <TextBlock x:Name="EmployeeNameText" 
                               Text=""
                               FontSize="20"
                               FontWeight="Bold"
                               Foreground="#333333"
                               HorizontalAlignment="Center"
                               Margin="0,0,0,10"
                               Visibility="Collapsed"/>

                    <!-- Status Message -->
                    <TextBlock x:Name="StatusMessage" 
                               Text="Clock-in successful at 8:05 AM"
                               Style="{StaticResource StatusTextStyle}"
                               Foreground="#4CAF50"
                               Margin="0,0,0,20"
                               Visibility="Collapsed"/>
                </StackPanel>

                <!-- Current Time Display -->
                <StackPanel Grid.Row="2" HorizontalAlignment="Center" Margin="0,0,0,20">
                    <TextBlock x:Name="CurrentTimeText" 
                               Text="12:34:56 PM"
                               FontSize="24"
                               FontWeight="Bold"
                               Foreground="#333333"
                               HorizontalAlignment="Center"/>
                    <TextBlock x:Name="CurrentDateText" 
                               Text="Monday, January 8, 2025"
                               FontSize="14"
                               Foreground="#666666"
                               HorizontalAlignment="Center"
                               Margin="0,5,0,0"/>
                </StackPanel>
            </Grid>

            <!-- Footer Instruction -->
            <Border Grid.Row="2" Background="#F5F5F5" Padding="20">
                <TextBlock x:Name="InstructionText"
                           Text="Place your finger to Clock-In/Clock-Out."
                           Style="{StaticResource InstructionTextStyle}"/>
            </Border>
        </Grid>

        <!-- Admin Panel (Hidden by default) -->
        <Grid x:Name="AdminPanel" Visibility="Collapsed" Background="#F6F7F9" Margin="12">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="400"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- LEFT PANEL: Scanner Section -->
            <Border Grid.Column="0" Background="{StaticResource CardBgBrush}" 
                    CornerRadius="12" Padding="20" Margin="0,0,12,0"
                    BorderBrush="#E6E9EE" BorderThickness="1">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- Title and Clock -->
                    <Grid Grid.Row="0" Margin="0,0,0,16">
                        <TextBlock Text="ðŸ‘† Fingerprint Scanner" 
                                   FontSize="20" FontWeight="Bold" 
                                   Foreground="{StaticResource PrimaryBrush}"
                                   VerticalAlignment="Center"/>
                        <StackPanel HorizontalAlignment="Right" VerticalAlignment="Center">
                            <TextBlock x:Name="ClockTextBlock" Text="00:00:00" 
                                       FontSize="24" FontWeight="Bold" 
                                       Foreground="{StaticResource PrimaryBrush}"
                                       HorizontalAlignment="Right"/>
                            <TextBlock x:Name="DateTextBlock" Text="January 1, 2024" 
                                       FontSize="12" 
                                       Foreground="{StaticResource MutedBrush}"
                                       HorizontalAlignment="Right"
                                       Margin="0,2,0,0"/>
                        </StackPanel>
                    </Grid>

                    <!-- Status -->
                    <Border Grid.Row="1" Background="{StaticResource SurfaceBrush}" 
                            CornerRadius="8" Padding="16" Margin="0,0,0,16">
                        <TextBlock x:Name="StatusTextBlock" Text="Ready to scan..." 
                                   TextWrapping="Wrap"
                                   FontSize="14" 
                                   Foreground="{StaticResource MutedBrush}"/>
                    </Border>

                    <!-- Fingerprint Image Placeholder -->
                    <Border Grid.Row="2" Background="{StaticResource SurfaceBrush}" 
                            CornerRadius="12" Padding="20"
                            HorizontalAlignment="Center" VerticalAlignment="Center"
                            Width="300" Height="300">
                        <Viewbox>
                            <TextBlock Text="ðŸ‘†" FontSize="120" 
                                       HorizontalAlignment="Center" 
                                       VerticalAlignment="Center"
                                       Opacity="0.3"/>
                        </Viewbox>
                    </Border>

                    <!-- Buttons -->
                    <StackPanel Grid.Row="3" Margin="0,16,0,0">
                        <TextBlock Text="Place your finger on the scanner" 
                                   FontSize="13" 
                                   Foreground="{StaticResource MutedBrush}"
                                   TextAlignment="Center"
                                   Margin="0,0,0,12"/>
                        <Button x:Name="GoEnrollBtn" Content="ðŸ“ Go to Enrollment" 
                                Click="GoEnrollBtn_Click" 
                                Style="{StaticResource PrimaryButton}" 
                                HorizontalAlignment="Stretch"
                                Margin="0,0,0,8"/>
                        <Button x:Name="RefreshBtn" Content="ðŸ”„ Refresh List" 
                                Click="RefreshBtn_Click" 
                                Style="{StaticResource NeutralButton}"
                                HorizontalAlignment="Stretch"/>
                        <Button x:Name="ToggleViewBtn" Content="ðŸ‘ï¸ Toggle View" 
                                Click="ToggleViewBtn_Click" 
                                Style="{StaticResource PrimaryButton}"
                                HorizontalAlignment="Stretch"
                                Margin="0,8,0,0"/>
                        <Button x:Name="OvertimeManagementBtn" Content="â° Manage Overtime" 
                                Click="OvertimeManagementBtn_Click" 
                                Style="{StaticResource PrimaryButton}"
                                HorizontalAlignment="Stretch"
                                Margin="0,8,0,0"/>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- RIGHT PANEL: Attendance Log -->
            <Border Grid.Column="1" Background="{StaticResource CardBgBrush}" 
                    CornerRadius="12" Padding="20"
                    BorderBrush="#E6E9EE" BorderThickness="1">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>

                    <!-- Header -->
                    <StackPanel Grid.Row="0" Margin="0,0,0,16">
                        <TextBlock Text="ðŸ“‹ Today's Attendance Log" 
                                   FontSize="20" FontWeight="Bold" 
                                   Foreground="{StaticResource PrimaryBrush}"
                                   Margin="0,0,0,8"/>
                        <TextBlock Text="Real-time attendance records" 
                                   FontSize="13" 
                                   Foreground="{StaticResource MutedBrush}"/>
                    </StackPanel>

                    <!-- Data Grid -->
                    <DataGrid x:Name="SessionsGrid" Grid.Row="1" 
                              AutoGenerateColumns="False" 
                              IsReadOnly="True" 
                              CanUserResizeRows="False"
                              HeadersVisibility="Column"
                              GridLinesVisibility="None"
                              Background="White"
                              BorderBrush="#e5e7eb"
                              BorderThickness="1"
                              RowHeight="40"
                              ColumnHeaderHeight="44"
                              AlternatingRowBackground="#f9fafb"
                              SelectionMode="Single"
                              SelectionUnit="FullRow">
                        <DataGrid.Columns>
                            <DataGridTextColumn Header="ID" Binding="{Binding Id}" Width="60"/>
                            <DataGridTextColumn Header="Employee ID" Binding="{Binding EmployeeId}" Width="120"/>
                            <DataGridTextColumn Header="Employee Name" Binding="{Binding EmployeeName}" Width="1*"/>
                            <DataGridTextColumn Header="Date" Binding="{Binding Date}" Width="1*"/>
                            <DataGridTextColumn Header="Clock In" Binding="{Binding ClockIn}" Width="1*"/>
                            <DataGridTextColumn Header="Clock Out" Binding="{Binding ClockOut}" Width="1*"/>
                            <DataGridTextColumn Header="Hours" Binding="{Binding TotalHours}" Width="1*"/>
                            <DataGridTextColumn Header="Status" Binding="{Binding Status}" Width="1*"/>
                        </DataGrid.Columns>
                        
                        <DataGrid.ColumnHeaderStyle>
                            <Style TargetType="DataGridColumnHeader">
                                <Setter Property="Background" Value="#f1f5f9"/>
                                <Setter Property="Foreground" Value="#1e293b"/>
                                <Setter Property="FontSize" Value="13"/>
                                <Setter Property="FontWeight" Value="SemiBold"/>
                                <Setter Property="Padding" Value="12,8"/>
                                <Setter Property="BorderThickness" Value="0"/>
                                <Setter Property="HorizontalContentAlignment" Value="Center"/>
                            </Style>
                        </DataGrid.ColumnHeaderStyle>
                        
                        <DataGrid.CellStyle>
                            <Style TargetType="DataGridCell">
                                <Setter Property="Padding" Value="12,6"/>
                                <Setter Property="Foreground" Value="#1f2937"/>
                                <Setter Property="BorderThickness" Value="0"/>
                                <Setter Property="TextBlock.TextAlignment" Value="Center"/>
                                <Setter Property="VerticalContentAlignment" Value="Center"/>
                                <Setter Property="Template">
                                    <Setter.Value>
                                        <ControlTemplate TargetType="DataGridCell">
                                            <Border Background="{TemplateBinding Background}"
                                                    BorderBrush="{TemplateBinding BorderBrush}"
                                                    BorderThickness="{TemplateBinding BorderThickness}"
                                                    Padding="{TemplateBinding Padding}">
                                                <ContentPresenter VerticalAlignment="Center" HorizontalAlignment="Center"/>
                                            </Border>
                                        </ControlTemplate>
                                    </Setter.Value>
                                </Setter>
                                <Style.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="Foreground" Value="#1f2937"/>
                                        <Setter Property="BorderBrush" Value="Transparent"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.CellStyle>
                        
                        <DataGrid.RowStyle>
                            <Style TargetType="DataGridRow">
                                <Setter Property="SnapsToDevicePixels" Value="True"/>
                                <Style.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="BorderBrush" Value="Transparent"/>
                                    </Trigger>
                                </Style.Triggers>
                            </Style>
                        </DataGrid.RowStyle>
                    </DataGrid>
                </Grid>
            </Border>
        </Grid>

        <!-- Toggle Button (Always visible) -->
        <Button x:Name="AdminToggleBtn" 
                Content="âš™ï¸"
                Width="40" Height="40"
                Background="#333333"
                Foreground="White"
                BorderThickness="0"
                HorizontalAlignment="Right"
                VerticalAlignment="Top"
                Margin="20"
                Click="AdminToggleBtn_Click"
                ToolTip="Toggle Admin Panel">
            <Button.Template>
                <ControlTemplate TargetType="Button">
                    <Border Background="{TemplateBinding Background}"
                            CornerRadius="20"
                            SnapsToDevicePixels="True">
                        <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                    </Border>
                </ControlTemplate>
            </Button.Template>
        </Button>
    </Grid>
</Page>